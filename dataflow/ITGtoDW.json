{
	"name": "toDW_dimTable",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "IN_DIM_Stockitem",
						"type": "DatasetReference"
					},
					"name": "ITGdimensionStockitem"
				},
				{
					"dataset": {
						"referenceName": "IN_DIM_City",
						"type": "DatasetReference"
					},
					"name": "ITGdimensionCity"
				},
				{
					"dataset": {
						"referenceName": "IN_DIM_Customer",
						"type": "DatasetReference"
					},
					"name": "ITGdimensionCustomer"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DW_dimStockitem",
						"type": "DatasetReference"
					},
					"name": "DWdimensionStockitem"
				},
				{
					"dataset": {
						"referenceName": "DW_dimCity",
						"type": "DatasetReference"
					},
					"name": "DWdimensionCity"
				},
				{
					"dataset": {
						"referenceName": "DW_dimCustomer",
						"type": "DatasetReference"
					},
					"name": "DWdimensionCustomer"
				}
			],
			"transformations": [
				{
					"name": "LatestVersion"
				},
				{
					"name": "LatestVersion1"
				},
				{
					"name": "LatestVersion2"
				}
			],
			"script": "source(output(\n\t\tStockItemKey as integer,\n\t\tStockItemID as integer,\n\t\tStockItemName as string,\n\t\tSupplierID as integer,\n\t\tColorID as integer,\n\t\tUnitPackageID as integer,\n\t\tOuterPackageID as integer,\n\t\tBrand as string,\n\t\tSize as string,\n\t\tLeadTimeDays as integer,\n\t\tQuantityPerOuter as integer,\n\t\tIsChillerStock as boolean,\n\t\tBarcode as string,\n\t\tTaxRate as decimal(18,3),\n\t\tUnitPrice as decimal(18,2),\n\t\tRecommendedRetailPrice as decimal(18,2),\n\t\tTypicalWeightPerUnit as decimal(18,3),\n\t\tMarketingComments as string,\n\t\tInternalComments as string,\n\t\tPhoto as binary,\n\t\tCustomFields as string,\n\t\tTags as string,\n\t\tSearchDetails as string,\n\t\tLastEditedBy as integer,\n\t\tValidFrom as timestamp,\n\t\tValidTo as timestamp,\n\t\tCurrentFlag as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> ITGdimensionStockitem\nsource(output(\n\t\tCityKey as integer,\n\t\tCityID as integer,\n\t\tCityName as string,\n\t\tLocation as binary,\n\t\tLatestRecordedPopulation as long,\n\t\tLastEditedBy as integer,\n\t\tValidFrom as timestamp,\n\t\tValidTo as timestamp,\n\t\tCurrentFlag as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> ITGdimensionCity\nsource(output(\n\t\tCustomerKey as integer,\n\t\tCustomerID as integer,\n\t\tCustomerName as string,\n\t\tBillToCustomer as string,\n\t\tPrimaryContactPerson as string,\n\t\tPhoneNumber as string,\n\t\tFaxNumber as string,\n\t\tDeliveryPostalCode as string,\n\t\tValidFrom as timestamp,\n\t\tValidTo as timestamp,\n\t\tCurrentFlag as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> ITGdimensionCustomer\nITGdimensionStockitem filter(CurrentFlag == 1) ~> LatestVersion\nITGdimensionCity filter(CurrentFlag == 1) ~> LatestVersion1\nITGdimensionCustomer filter(CurrentFlag == 1) ~> LatestVersion2\nLatestVersion sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\t{Stock Item Key} as integer,\n\t\t{WWI Stock Item ID} as integer,\n\t\t{Stock Item} as string,\n\t\tColor as string,\n\t\t{Selling Package} as string,\n\t\t{Buying Package} as string,\n\t\tBrand as string,\n\t\tSize as string,\n\t\t{Lead Time Days} as integer,\n\t\t{Quantity Per Outer} as integer,\n\t\t{Is Chiller Stock} as boolean,\n\t\tBarcode as string,\n\t\t{Tax Rate} as decimal(18,3),\n\t\t{Unit Price} as decimal(18,2),\n\t\t{Recommended Retail Price} as decimal(18,2),\n\t\t{Typical Weight Per Unit} as decimal(18,3),\n\t\tPhoto as binary,\n\t\t{Valid From} as timestamp,\n\t\t{Valid To} as timestamp,\n\t\t{Lineage Key} as integer\n\t),\n\tdeletable:false,\n\tinsertable:false,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['WWI Stock Item ID'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\t{Stock Item Key} = StockItemKey,\n\t\t{WWI Stock Item ID} = StockItemID,\n\t\t{Stock Item} = StockItemName,\n\t\tColor = ColorID,\n\t\tBrand,\n\t\tSize,\n\t\t{Lead Time Days} = LeadTimeDays,\n\t\t{Quantity Per Outer} = QuantityPerOuter,\n\t\t{Is Chiller Stock} = IsChillerStock,\n\t\tBarcode,\n\t\t{Tax Rate} = TaxRate,\n\t\t{Unit Price} = UnitPrice,\n\t\t{Recommended Retail Price} = RecommendedRetailPrice,\n\t\t{Typical Weight Per Unit} = TypicalWeightPerUnit,\n\t\tPhoto,\n\t\t{Valid From} = ValidFrom,\n\t\t{Valid To} = ValidTo\n\t)) ~> DWdimensionStockitem\nLatestVersion1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\t{City Key} as integer,\n\t\t{WWI City ID} as integer,\n\t\tCity as string,\n\t\t{State Province} as string,\n\t\tCountry as string,\n\t\tContinent as string,\n\t\t{Sales Territory} as string,\n\t\tRegion as string,\n\t\tSubregion as string,\n\t\tLocation as binary,\n\t\t{Latest Recorded Population} as long,\n\t\t{Valid From} as timestamp,\n\t\t{Valid To} as timestamp,\n\t\t{Lineage Key} as integer\n\t),\n\tdeletable:false,\n\tinsertable:false,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['CityID'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\t{City Key} = CityKey,\n\t\t{WWI City ID} = CityID,\n\t\tCity = CityName,\n\t\tLocation,\n\t\t{Latest Recorded Population} = LatestRecordedPopulation,\n\t\t{Valid From} = ValidFrom,\n\t\t{Valid To} = ValidTo\n\t)) ~> DWdimensionCity\nLatestVersion2 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\t{Customer Key} as integer,\n\t\t{WWI Customer ID} as integer,\n\t\tCustomer as string,\n\t\t{Bill To Customer} as string,\n\t\tCategory as string,\n\t\t{Buying Group} as string,\n\t\t{Primary Contact} as string,\n\t\t{Postal Code} as string,\n\t\t{Valid From} as timestamp,\n\t\t{Valid To} as timestamp,\n\t\t{Lineage Key} as integer\n\t),\n\tdeletable:false,\n\tinsertable:false,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['WWI Customer ID'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\t{Customer Key} = CustomerKey,\n\t\t{WWI Customer ID} = CustomerID,\n\t\tCustomer = CustomerName,\n\t\t{Bill To Customer} = BillToCustomer,\n\t\t{Primary Contact} = PrimaryContactPerson,\n\t\t{Postal Code} = DeliveryPostalCode,\n\t\t{Valid From} = ValidFrom,\n\t\t{Valid To} = ValidTo\n\t)) ~> DWdimensionCustomer"
		}
	}
}